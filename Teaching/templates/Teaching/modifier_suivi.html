{% extends 'Teaching/base.html' %}
{% load static %}

{% block title %}Modifier le suivi - {{ object.course.label }} - YSEM{% endblock %}

{% block page_title %}Modifier le Suivi de Cours{% endblock %}

{% block content %}
<div class="container-fluid px-4">
    <!-- En-tête avec titre et actions -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card shadow-soft border-light">
                <div class="card-body">
                    <div class="row align-items-center d-flex justify-content-between">
                        <div class="">
                            <h4 class="h3 mb-0">
                                <i class="fas fa-edit text-dark me-2"></i>
                                Modifier le Suivi de Cours
                            </h4>
                            <p class="text-muted mb-0">{{ object.course.label }} - {{ object.lecturer.firstname }} {{ object.lecturer.lastname }}</p>
                        </div>
                        <div class="text-end">
                            <div class="btn-group">
                                <a href="{% url 'teaching:detail_suivi' object.pk %}" class="btn btn-outline-dark btn-sm">
                                    <i class="fas fa-arrow-left me-2"></i>
                                    Retour aux détails
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Formulaire de modification -->
    <div class="row">
        <div class="col-12">
            <div class="card shadow-soft border-light">
                <div class="card-header bg-white border-light">
                    <h6 class="mb-0">
                        <i class="fas fa-form text-dark me-2"></i>
                        Formulaire de modification
                    </h6>
                </div>
                <div class="card-body">
                    <form method="post">
                        {% csrf_token %}
                        
                        <div class="row">
                            <!-- Informations générales -->
                            <div class="col-md-6">
                                <h6 class="text-muted mb-3">Informations générales</h6>
                                
                                <div class="mb-3">
                                    <label for="{{ form.date.id_for_label }}" class="form-label">Date</label>
                                    {{ form.date }}
                                    {% if form.date.errors %}
                                        <div class="text-danger small mt-1">
                                            {{ form.date.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                                
                                <div class="mb-3">
                                    <label for="{{ form.lecturer.id_for_label }}" class="form-label">Enseignant</label>
                                    {{ form.lecturer }}
                                    {% if form.lecturer.errors %}
                                        <div class="text-danger small mt-1">
                                            {{ form.lecturer.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                                
                                <div class="mb-3">
                                    <label for="{{ form.course.id_for_label }}" class="form-label">Cours</label>
                                    {{ form.course }}
                                    {% if form.course.errors %}
                                        <div class="text-danger small mt-1">
                                            {{ form.course.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                                
                                <div class="mb-3">
                                    <label for="{{ form.level.id_for_label }}" class="form-label">Niveau</label>
                                    {{ form.level }}
                                    {% if form.level.errors %}
                                        <div class="text-danger small mt-1">
                                            {{ form.level.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                                
                                <div class="mb-3">
                                    <label for="{{ form.academic_year.id_for_label }}" class="form-label">Année académique</label>
                                    {{ form.academic_year }}
                                    {% if form.academic_year.errors %}
                                        <div class="text-danger small mt-1">
                                            {{ form.academic_year.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                            
                            <!-- Progression et contenu -->
                            <div class="col-md-6">
                                <h6 class="text-muted mb-3">Progression et contenu</h6>
                                
                                <div class="row">
                                    <div class="col-6">
                                        <div class="mb-3">
                                            <label for="{{ form.totalChapterCount.id_for_label }}" class="form-label">Chapitres prévus</label>
                                            {{ form.totalChapterCount }}
                                            {% if form.totalChapterCount.errors %}
                                                <div class="text-danger small mt-1">
                                                    {{ form.totalChapterCount.errors.0 }}
                                                </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="mb-3">
                                            <label for="{{ form.chapitre_fait.id_for_label }}" class="form-label">Chapitres faits</label>
                                            {{ form.chapitre_fait }}
                                            {% if form.chapitre_fait.errors %}
                                                <div class="text-danger small mt-1">
                                                    {{ form.chapitre_fait.errors.0 }}
                                                </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-6">
                                        <div class="mb-3">
                                            <label for="{{ form.contenu_seance_prevu.id_for_label }}" class="form-label">Contenu séance prévu</label>
                                            {{ form.contenu_seance_prevu }}
                                            {% if form.contenu_seance_prevu.errors %}
                                                <div class="text-danger small mt-1">
                                                    {{ form.contenu_seance_prevu.errors.0 }}
                                                </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="mb-3">
                                            <label for="{{ form.contenu_effectif_seance.id_for_label }}" class="form-label">Contenu effectif séance</label>
                                            {{ form.contenu_effectif_seance }}
                                            {% if form.contenu_effectif_seance.errors %}
                                                <div class="text-danger small mt-1">
                                                    {{ form.contenu_effectif_seance.errors.0 }}
                                                </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Activités pédagogiques -->
                        <div class="row mt-4">
                            <div class="col-12">
                                <h6 class="text-muted mb-3">Activités pédagogiques</h6>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <div class="form-check">
                                        {{ form.travaux_preparatoires }}
                                        <label for="{{ form.travaux_preparatoires.id_for_label }}" class="form-check-label">
                                            Travaux préparatoires
                                        </label>
                                    </div>
                                    {% if form.travaux_preparatoires.errors %}
                                        <div class="text-danger small mt-1">
                                            {{ form.travaux_preparatoires.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>

                                <div class="mb-3">
                                    <div class="form-check">
                                        {{ form.groupWork }}
                                        <label for="{{ form.groupWork.id_for_label }}" class="form-check-label">
                                            Travaux de groupe
                                        </label>
                                    </div>
                                    {% if form.groupWork.errors %}
                                        <div class="text-danger small mt-1">
                                            {{ form.groupWork.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>

                                <div class="mb-3">
                                    <div class="form-check">
                                        {{ form.classWork }}
                                        <label for="{{ form.classWork.id_for_label }}" class="form-check-label">
                                            Travaux en classe
                                        </label>
                                    </div>
                                    {% if form.classWork.errors %}
                                        <div class="text-danger small mt-1">
                                            {{ form.classWork.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>

                                <div class="mb-3">
                                    <div class="form-check">
                                        {{ form.homeWork }}
                                        <label for="{{ form.homeWork.id_for_label }}" class="form-check-label">
                                            Devoirs à domicile
                                        </label>
                                    </div>
                                    {% if form.homeWork.errors %}
                                        <div class="text-danger small mt-1">
                                            {{ form.homeWork.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="mb-3">
                                    <div class="form-check">
                                        {{ form.pedagogicActivities }}
                                        <label for="{{ form.pedagogicActivities.id_for_label }}" class="form-check-label">
                                            Activités pédagogiques
                                        </label>
                                    </div>
                                    {% if form.pedagogicActivities.errors %}
                                        <div class="text-danger small mt-1">
                                            {{ form.pedagogicActivities.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>

                                <div class="mb-3">
                                    <div class="form-check">
                                        {{ form.TDandTP }}
                                        <label for="{{ form.TDandTP.id_for_label }}" class="form-check-label">
                                            TD et TP
                                        </label>
                                    </div>
                                    {% if form.TDandTP.errors %}
                                        <div class="text-danger small mt-1">
                                            {{ form.TDandTP.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                                
                                <div class="mb-3">
                                    <label for="{{ form.projet_fin_cours.id_for_label }}" class="form-label">Projet de fin de cours</label>
                                    {{ form.projet_fin_cours }}
                                    {% if form.projet_fin_cours.errors %}
                                        <div class="text-danger small mt-1">
                                            {{ form.projet_fin_cours.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                                
                                <div class="mb-3">
                                    <label for="{{ form.association_pratique_aux_enseigements.id_for_label }}" class="form-label">Association pratique aux enseignements</label>
                                    {{ form.association_pratique_aux_enseigements }}
                                    {% if form.association_pratique_aux_enseigements.errors %}
                                        <div class="text-danger small mt-1">
                                            {{ form.association_pratique_aux_enseigements.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        
                        <!-- Observations -->
                        <div class="row mt-4">
                            <div class="col-12">
                                <h6 class="text-muted mb-3">Observations et solutions</h6>
                            </div>
                            
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="{{ form.observation.id_for_label }}" class="form-label">Observation</label>
                                    {{ form.observation }}
                                    {% if form.observation.errors %}
                                        <div class="text-danger small mt-1">
                                            {{ form.observation.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                            
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="{{ form.solution.id_for_label }}" class="form-label">Solution</label>
                                    {{ form.solution }}
                                    {% if form.solution.errors %}
                                        <div class="text-danger small mt-1">
                                            {{ form.solution.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                            
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="{{ form.generalObservation.id_for_label }}" class="form-label">Observation générale</label>
                                    {{ form.generalObservation }}
                                    {% if form.generalObservation.errors %}
                                        <div class="text-danger small mt-1">
                                            {{ form.generalObservation.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        
                        <!-- Form errors -->
                        {% if form.non_field_errors %}
                            <div class="alert alert-danger mt-3">
                                {{ form.non_field_errors }}
                            </div>
                        {% endif %}
                        
                        <!-- Submit buttons -->
                        <div class="d-flex justify-content-end gap-2 mt-4">
                            <a href="{% url 'teaching:detail_suivi' object.pk %}" class="btn btn-outline-secondary">
                                <i class="fas fa-times me-2"></i>
                                Annuler
                            </a>
                            <button type="submit" class="btn btn-warning">
                                <i class="fas fa-save me-2"></i>
                                Modifier le suivi
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
